<!DOCTYPE html>
<html>
<head>
  <title>Reaction Test</title>
  <style>
    #progressBar {
      width: 100%;
      height: 20px;
      background-color: #ccc;
    }
    #progressBar div {
      height: 100%;
      background-color: #4CAF50;
      width: 0;
      transition: width 0.25s;
    }
    #button {
      width: 100px;
      height: 100px;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -50px 0 0 -50px;
      background-color: green;
    }
    #restartButton {
      position: absolute;
      bottom: 10px;
      left: 10px;
      width: 100px;
      height: 100px;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <div id="progressBar"><div id="progress"></div></div>
  <button id="button"></button>
  <div id="results"></div>
  <div id="attempts"></div>
  <button id="restartButton">Restart</button>

  <script>
    let erika = new Audio("Erika.mp3")
    const button = document.getElementById('button');
    const progress = document.getElementById('progress');
    const results = document.getElementById('results');
    const attempts = document.getElementById('attempts');
    const restartButton = document.getElementById('restartButton');
    let attemptsCount = 0;
    let successes = 0;
    let totalTime = 0;
    let audio = erika;
    let isAudioPlaying = false;

    function startProgress() {
      attemptsCount = 0;
      successes = 0;
      totalTime = 0;
      progress.style.width = '0%';
      const interval = setInterval(() => {
        progress.style.width = `${(attemptsCount / 15) * 100}%`;
        if (attemptsCount >= 15) {
          clearInterval(interval);
          button.removeEventListener('click', handleClick);
          results.textContent = `Successful attempts: ${successes}\nFailed attempts: ${attemptsCount - successes}\nMid time of successful attempts: ${totalTime / successes}ms`;
          attempts.textContent = `Attempts: ${15}`;
          erika.pause();
          erika.currentTime = 10;
          isAudioPlaying = false;
        }
      }, 1000);
    }

    function handleClick() {
      if (isAudioPlaying && attemptsCount<15) {
        attemptsCount++;
        successes++;
        totalTime += new Date() - startTime;
        results.textContent += `\nSuccessful attempt ${attemptsCount} - time: ${new Date() - startTime}ms`;
        erika.pause();
        erika.currentTime = 10;
        isAudioPlaying = false;
        startAudio();
      } else if (attemptsCount < 15) {
        attemptsCount++;
        results.textContent += `\nFailed attempt ${attemptsCount}`;
      }
    }

    function startAudio() {
      if (attemptsCount < 15) {
        const delay = Math.floor(Math.random() * 2000) + 1000; // Random delay between 1 and 3 seconds
        setTimeout(() => {
          erika.play();
          startTime = new Date();
          button.addEventListener('click', handleClick);
          isAudioPlaying = true;
        }, delay);
      }
    }

    function restartGame() {
      attemptsCount = 0;
      successes = 0;
      totalTime = 0;
      progress.style.width = '0%';
      results.textContent = '';
      attempts.textContent = '';
      erika.pause();
      erika.currentTime = 10;
      isAudioPlaying = false;
      startAudio();
      startProgress();
      erika.pause;
      erika.currentTime = 10;
      isAudioPlaying = false;
    }

    let startTime;
    startAudio();
    startProgress();
    restartButton.addEventListener('click', restartGame);
  </script>
</body>
</html>