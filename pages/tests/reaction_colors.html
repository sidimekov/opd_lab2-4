<!DOCTYPE html>
<html>
<head>
  <title>Reaction Test</title>
  <style>
    #progressBar {
      width: 100%;
      height: 20px;
      background-color: #ccc;
    }
    #progressBar div {
      height: 100%;
      background-color: #4CAF50;
      width: 0;
      transition: width 0.25s;
    }
    #circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background-color: #ccc;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -50px 0 0 -50px;
    }
    #button1 {
      width: 100px;
      height: 100px;
      position: absolute;
      bottom: 10px;
      left: 10px;
      background-color: red;
    }
    #button2 {
      width: 100px;
      height: 100px;
      position: absolute;
      bottom: 10px;
      left: 120px;
      background-color: blue;
    }
    #button3 {
      width: 100px;
      height: 100px;
      position: absolute;
      bottom: 10px;
      left: 230px;
      background-color: green;
    }
    #restartButton {
      position: absolute;
      bottom: 10px;
      right: 10px;
      width: 100px;
      height: 100px;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <div id="progressBar"><div id="progress"></div></div>
  <div id="circle"></div>
  <div id="results"></div>
  <div id="attempts"></div>
  <button id="button1"></button>
  <button id="button2"></button>
  <button id="button3"></button>
  <button id="restartButton">Restart</button>

  <script>
const circle = document.getElementById('circle');
const button1 = document.getElementById('button1');
const button2 = document.getElementById('button2');
const button3 = document.getElementById('button3');
const results = document.getElementById('results');
button1.style.backgroundColor = 'green';
button2.style.backgroundColor = 'blue';
button3.style.backgroundColor = 'red';
const attempts = document.getElementById('attempts');
const restartButton = document.getElementById('restartButton');
let attemptsCount = 0;
let successes = 0;
let totalTime = 0;
let currentColor = '#ccc';

function startProgress() {
    if (attemptsCount < 15) {
        attemptsCount = 0;
        successes = 0;
        totalTime = 0;
        progress.style.width = '0%';
        const interval = setInterval(() => {
            progress.style.width = `${(attemptsCount / 15) * 100}%`;
            if (attemptsCount >= 15) {
                clearInterval(interval);
                button1.removeEventListener('click', handleClick);
                button2.removeEventListener('click', handleClick);
                button3.removeEventListener('click', handleClick);
                results.textContent = `Successful attempts: ${successes}\nFailed attempts: ${attemptsCount - successes}\nMid time of successful attempts: ${totalTime / successes}ms`;
                attempts.textContent = `Attempts: ${15}`;
            }
        }, 1000);
    }
}

function handleClick(event) {
    if (attemptsCount < 15) {
        attemptsCount++;
        if (event.target.style.backgroundColor === currentColor) {
            successes++;
            totalTime += new Date() - startTime;
            circle.style.backgroundColor = 'gray';
            results.textContent += `\nSuccessful attempt ${attemptsCount} - time: ${new Date() - startTime}ms`;
        } else {
            results.textContent += `\nFailed attempt ${attemptsCount}`;
        }
        setTimeout(() => {
            startButton();
        }, Math.floor(Math.random() * 2000) + 1000); // Add 1-3 second delay before next attempt
    }
}

function startButton() {
    if (attemptsCount < 15) {
        circle.style.backgroundColor = 'gray'; // Set circle to gray during delay
        const delay = Math.floor(Math.random() * 2000) + 1000; // Random delay between 1 and 3 seconds
        setTimeout(() => {
            const colors = ['red', 'blue', 'green'];
            startTime = new Date();
            currentColor = colors[Math.floor(Math.random() * colors.length)];
            circle.style.backgroundColor = currentColor;
            button1.addEventListener('click', handleClick);
            button2.addEventListener('click', handleClick);
            button3.addEventListener('click', handleClick);
        }, delay);
    }
}

function restartGame() {
    attemptsCount = 0;
    successes = 0;
    totalTime = 0;
    progress.style.width = '0%';
    results.textContent = '';
    attempts.textContent = '';
    startButton();
    startProgress();
}

let startTime;
startButton();
startProgress();
restartButton.addEventListener('click', restartGame);
  </script>
</body>
</html>