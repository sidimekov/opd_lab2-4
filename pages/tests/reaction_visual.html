<!DOCTYPE html>
<html>
<head>
  <title>Reaction Test</title>
  <style>
    #progressBar {
      width: 100%;
      height: 20px;
      background-color: #ccc;
    }
    #progressBar div {
      height: 100%;
      background-color: #4CAF50;
      width: 0;
      transition: width 0.25s;
    }
    #button {
      width: 100px;
      height: 100px;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -50px 0 0 -50px;
      background-color: red;
    }
    #restartButton {
      position: absolute;
      bottom: 10px;
      left: 10px;
      width: 100px;
      height: 100px;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <div id="progressBar"><div id="progress"></div></div>
  <button id="button"></button>
  <div id="results"></div>
  <div id="attempts"></div>
  <button id="restartButton">Restart</button>

  <script>
    const button = document.getElementById('button');
    const progress = document.getElementById('progress');
    const results = document.getElementById('results');
    const attempts = document.getElementById('attempts');
    const restartButton = document.getElementById('restartButton');
    let attemptsCount = 0;
    let successes = 0;
    let totalTime = 0;

    function startProgress() {
      attemptsCount = 0;
      successes = 0;
      totalTime = 0;
      progress.style.width = '0%';
      const interval = setInterval(() => {
        progress.style.width = `${(attemptsCount / 15) * 100}%`;
        if (attemptsCount >= 15) {
          clearInterval(interval);
          button.removeEventListener('click', handleClick);
          button.style.backgroundColor = 'green';
          results.textContent = `Successful attempts: ${successes}\nFailed attempts: ${attemptsCount - successes}\nMid time of successful attempts: ${totalTime / successes}ms`;
          attempts.textContent = `Attempts: ${15}`;
        }
      }, 1000);
    }

    function handleClick() {
      attemptsCount++;
      if (button.style.backgroundColor === 'green') {
        successes++;
        totalTime += new Date() - startTime;
        results.textContent += `\nSuccessful attempt ${attemptsCount} - time: ${new Date() - startTime}ms`;
      } else {
        results.textContent += `\nFailed attempt ${attemptsCount}`;
      }
      startButton();
    }

    function startButton() {
      const delay = Math.floor(Math.random() * 1500) + 2000; // Random delay between 2 and 3,5 seconds
      startTime = new Date();
      button.style.backgroundColor = 'red';
      setTimeout(() => {
        button.style.backgroundColor = 'green';
        startTime = new Date();
        button.addEventListener('click', handleClick);
      }, delay);
    }

    function restartGame() {
      attemptsCount = 0;
      successes = 0;
      totalTime = 0;
      progress.style.width = '0%';
      results.textContent = '';
      attempts.textContent = '';
      startButton();
      startProgress();
    }

    let startTime;
    startButton();
    startProgress();
    restartButton.addEventListener('click', restartGame);
  </script>
</body>
</html>